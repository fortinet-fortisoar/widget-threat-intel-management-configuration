<!-- Copyright start
  Copyright (C) 2008 - 2023 Fortinet Inc.
  All rights reserved.
  FORTINET CONFIDENTIAL & FORTINET PROPRIETARY SOURCE CODE
  Copyright end -->
<link rel="stylesheet" type="text/css" href="{{widgetCSS}}" />
<div class="modal-header">
    <h3 class="modal-title col-md-9">Threat Intel Management Configuration</h3>
</div>
<script
    src="threatIntelManagementConfiguration-1.0.0/widgetAssets/js/threatIntelManagementConfiguration.service.js"></script>

<wizard on-finish="close()" indicators-position="top"
    class="cs-wizard ingestion-steps solutionpack-wizard-steps tim-config-steps" name="timSolutionpackWizard">
    <wz-step wz-title="Start" wz-order="1" class="ingestion-modal-padding wizard-first-step full-width">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-6 display-flex" style="justify-content: center">
                            <img class="img-responsive step-image"
                                src="widgets/installed/threatIntelManagementConfiguration-1.0.0/images/firstPage.svg">
                        </div>
                        <div class="col-md-6 prerequisites-section padding-bottom-25 padding-left-0">
                            <div class="font-size-30 muted-80 line-height-1 padding-bottom-md">Welcome</div>
                            <div
                                class="solid-border element-secondary-bgcolor margin-right-25 padding-top-md padding-bottom-md">
                                <p class="margin-left-15 font-Size-13 muted"><span>This wizard is designed to guide you
                                        through setting
                                        up Threat Intel Management Configuration within your FortiSOAR environment. From
                                        selecting and
                                        configuring feed integrations, scheduling feed ingestion, setting up Threat
                                        Intel settings, and configuring Solution Packs to optimize your threat
                                        intelligence infrastructure.</span></p>
                                <h6
                                    class="margin-left-15 font-weight-normal margin-bottom-sm modal-title text-transform-none">
                                    Prerequisites</h6>
                                <p class="font-Size-13 margin-bottom-0 margin-left-15 muted">
                                    <span>Before we begin, ensure you have the necessary configuration details for the
                                        integrations at hand. These details will be crucial as we proceed with setting
                                        up your threat intelligence management system.</span>
                                </p>
                            </div>
                            <button type="button"
                                class="btn btn-primary btn-sm margin-top-xlg text-transform-none font-size-14"
                                data-ng-click="moveToSelectConnector()" id="solutionpack-next-btn">
                                <!-- Conditional Text Rendering -->
                                <span data-ng-if="isFortiGuardConectorInsttalled === false">Installing Fortinet
                                    FortiGuard Connector...</span>
                                <span data-ng-if="isFortiGuardConectorInsttalled === true">Let's get started</span>
                                <!-- Conditional Icon Rendering -->
                                <i class="fa margin-left-sm"
                                    data-ng-class="!isFortiGuardConectorInsttalled ? 'fa-spin fa-spinner' : 'fa-chevron-right'"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </wz-step>
    <wz-step wz-title="Select Feed Integrations" wz-order="2" class="ingestion-modal-padding full-width">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-6 display-flex margin-top-70" style="justify-content: center">
                            <img class="img-responsive step-image"
                                src="widgets/installed/threatIntelManagementConfiguration-1.0.0/images/secondPage.svg">
                        </div>
                        <div class="col-md-6 prerequisites-section padding-bottom-25 padding-left-0" style="
                        height: calc(100vh - 300px);">
                            <div class="font-size-30 muted-80 line-height-1 padding-bottom-md">Select Feed Integrations
                            </div>
                            <p class="font-Size-13 muted"><span>Select necessary feed sources to fetch and ingest feeds
                                    into the FortiSOAR Threat Feed module. </span></p>
                            <div
                                class="solid-border element-secondary-bgcolor padding-20 margin-top-md padding-top-md padding-bottom-md">
                                <h6 class="font-weight-normal margin-bottom-sm modal-title text-transform-none">
                                    Default Feed Sources</h6>
                                <p class="font-Size-13 muted">
                                    <span>As part of the Threat Intel Management Solution Pack installation, FortiGuard
                                        Threat Intel integration is automatically installed and configured to retrieve
                                        the feeds.</span>
                                </p>
                                <div class="display-flex font-size-12">
                                    <img src="{{fortiGuardConector.iconLarge}}" alt="" height="60px"
                                        style="border-radius: 4px;margin-right: 10px;">
                                    <table>
                                        <tr>
                                            <td style="color: #A3AAB7;">Name</td>
                                            <td>
                                                <span>{{fortiGuardConector.label}} | </span>
                                                <i data-ng-if="isFortiGuardConectorInsttalled"
                                                    class="font-size-14 margin-0 text-center margin-top-sm text-success text-success icon icon-approval margin-right-sm"></i>
                                                <i data-ng-if="!isFortiGuardConectorInsttalled"
                                                    class="font-size-14 margin-0 text-center margin-top-sm margin-bottom-sm text-danger icon icon-failed margin-right-sm"></i>
                                                <span> Installed</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="color: #A3AAB7;">Version</td>
                                            <td>{{fortiGuardConector.version}}</td>
                                        </tr>
                                        <tr>
                                            <td style="padding-right: 25px; color: #A3AAB7;">Published by </td>
                                            <td>{{fortiGuardConector.publisher}}</td>
                                        </tr>
                                        <tr>
                                            <td style="color: #A3AAB7;">Certified </td>
                                            <td>{{fortiGuardConector.certified ? 'Yes' : 'No'}}</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div
                                class="solid-border element-secondary-bgcolor padding-20 margin-top-md padding-top-md padding-bottom-md">
                                <h6 class="font-weight-normal margin-bottom-sm modal-title text-transform-none">
                                    Additional Feed Sources</h6>
                                <p class="margin-bottom-sm font-Size-13 muted">
                                    <span>Select the integrations from the list of Additional Feed sources that you wish
                                        to fetch feeds from.</span>
                                </p>
                                <input class="form-control margin-bottom-sm" type="text" placeholder="Search"
                                    ng-model="searchQuery">
                                <div style="overflow: auto; height: calc(100vh - 625px);">
                                    <div class="additional-feed-connector">
                                        <uib-accordion close-others="true">
                                            <div uib-accordion-group
                                                ng-repeat="connector in feedConnectors | filter:searchQuery"
                                                is-open="connector.toggleSelectFeeds" class="panel-default"
                                                style="width: 100%;">
                                                <uib-accordion-heading class="padding-md">
                                                    <div class="align-items-center display-flex">
                                                        <div
                                                            class="checkbox margin-bottom-0 margin-right-md margin-top-0">
                                                            <label for="selectConnector-{{connector.uuid}}">
                                                                <input
                                                                    ng-click="toggleSelectFeedsSettings($event)"
                                                                    class="padding-top-7" type="checkbox"
                                                                    id="selectConnector-{{connector.uuid}}"
                                                                    data-ng-model="connector.selectConnector"
                                                                    data-ng-disabled="connector.installed" />
                                                            </label>
                                                        </div>
                                                        <div data-ng-class="{'queue-text-active-color': connector.toggleSelectFeeds
                                                                }">
                                                            <div class="font-size-14 margin-right-lg pull-left">
                                                                <span class="queue-card-actions">&nbsp;<i
                                                                        class="fa {{ connector.toggleSelectFeeds ? 'fa-chevron-down' : 'fa-chevron-right'}}"></i></span>
                                                            </div>
                                                            <div class="font-size-14 font-weight-normal pull-left">
                                                                {{connector.label}}
                                                            </div>
                                                            <div class="clearfix"></div>
                                                        </div>
                                                    </div>
                                                </uib-accordion-heading>
                                                <div class="display-flex font-size-12 padding-left-18">
                                                    <img src="{{connector.iconLarge}}" alt="" height="60px"
                                                        style="border-radius: 4px;margin-right: 10px;">
                                                    <table>
                                                        <tr>
                                                            <td style="color: #A3AAB7;">Installed</td>
                                                            <td class="text-capitalize">
                                                                {{connector.installed}}
                                                                <i data-ng-if="connector.installed"
                                                                    class="font-size-14 margin-0 text-center margin-top-sm text-success text-success icon icon-approval margin-right-sm"></i>
                                                                <i data-ng-if="!connector.installed"
                                                                    class="font-size-14 margin-0 text-center margin-top-sm margin-bottom-sm text-danger icon icon-failed margin-right-sm"></i>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="color: #A3AAB7;">Version</td>
                                                            <td>{{connector.version}}</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="padding-right: 25px; color: #A3AAB7;">Published
                                                                by </td>
                                                            <td>{{connector.publisher}}</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="color: #A3AAB7;">Certified </td>
                                                            <td>{{connector.certified ? 'Yes' : 'No'}}</td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>
                                        </uib-accordion>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ingestion-modal-footer">
            <button type="button" class="btn btn-sm btn-second-primary margin-top-lg margin-left-lg"
                id="version-control-back-btn" data-ng-click="backToStartPage()"><i
                    class="fa fa-chevron-left margin-right-sm"></i>Back</button>
            <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                data-ng-click="installConnector()" id="version-control-next-btn">Proceed & install<i
                    class="fa fa-chevron-right margin-left-sm"></i>
            </button>
        </div>
    </wz-step>
    <wz-step wz-title="Install Feed Integrations" wz-order="3" class="ingestion-modal-padding full-width">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-6 display-flex" style="justify-content: center">
                            <img class="img-responsive padding-top-70 step-image"
                                src="widgets/installed/threatIntelManagementConfiguration-1.0.0/images/secondPage.svg">
                        </div>
                        <div class="col-md-6 prerequisites-section padding-bottom-30 padding-left-0 padding-right-30 padding-top-30"
                            style="height: calc(100vh - 220px);">
                            <div class="font-size-30 muted-80 line-height-1 padding-bottom-md">Install Feed Integrations
                            </div>
                            <p class="font-Size-13 muted"><span>On this page, you will find the installation status of
                                    the feed integration you selected on the previous page.</span></p>
                            <h6 class="font-weight-normal margin-bottom-sm modal-title text-transform-none">
                                Installation Progress</h6>
                            <p class="font-Size-13 muted">
                                <span>Total Connectors {{getSelectedConnectorsCount()}}</span>
                            </p>
                            <div style="overflow: auto; height: calc(100vh - 432px);">
                                <div ng-if="connector.selectConnector" ng-repeat="connector in feedConnectors"
                                    class="padding-5 display-flex-space-between"
                                    style="border: 1px solid #29323E;padding: 10px; width: 85%; margin-bottom: 10px;">
                                    <div style="color: #D2D5DA;"
                                        class="padding-5 queue-card-header-text margin-right-3 font-size-14">
                                        {{connector.label}}
                                    </div>
                                    <div
                                        class="font-size-14 text-center margin-top-sm margin-bottom-sm justify-content margin-left-auto margin-right-sm">
                                        <i data-ng-if="!connector.installed && connector.selectConnector"
                                            class="text-color-warning icon icon-installing-lodder-static"><span>
                                                Installing...</span></i>
                                        <i data-ng-if="connector.installed && connector.selectConnector"
                                            class="text-success icon icon-check"><span>
                                                Installed</span></i>
                                        <i data-ng-if="!connector.installed && !connector.selectConnector"
                                            class="text-danger icon icon-failed"><span>
                                                Installed Failed</span></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ingestion-modal-footer">
            <button type="button" class="btn btn-sm btn-second-primary margin-top-lg margin-left-lg"
                id="version-control-back-btn" data-ng-click="backToinstallConnector()"><i
                    class="fa fa-chevron-left margin-right-sm"></i>Back</button>
            <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                data-ng-click="moveToConfigureConnector()" id="version-control-next-btn-config">
                <span data-ng-if="allConnectorsInstalled === false">Checking connector installation...</span>
                <span data-ng-if="allConnectorsInstalled === true">Configure Connectors</span>
                <i class="fa margin-left-sm"
                    data-ng-class="!allConnectorsInstalled ? 'fa-spin fa-spinner' : 'fa-chevron-right'"></i>
            </button>
        </div>
</wizard>